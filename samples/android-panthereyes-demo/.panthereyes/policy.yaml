# PantherEyes sample policy for the Android demo app.
# Note: the current policy engine resolves target overrides under `mobile` (not `android`).
configVersion: 1
version: 1
defaults:
  mode: warn
  failOnSeverity: high
  directives:
    minScore: 80
    allowDemoCleartext: false
    requireExceptionApproval: true
  ruleOverrides:
    mobile.android.cleartext-traffic-enabled:
      severity: high
    mobile.android.debuggable-enabled:
      severity: medium
envs:
  dev:
    mode: audit
    failOnSeverity: critical
    directives:
      minScore: 60
      allowDemoCleartext: true
      sampleEnvironmentLabel: android-dev
    ruleOverrides:
      mobile.android.cleartext-traffic-enabled:
        severity: low
      mobile.android.debuggable-enabled:
        severity: low
    targets:
      mobile:
        directives:
          platform: android
          networkProfile: relaxed
  staging:
    mode: warn
    failOnSeverity: high
    directives:
      minScore: 80
      allowDemoCleartext: false
      sampleEnvironmentLabel: android-staging
    targets:
      mobile:
        directives:
          platform: android
          networkProfile: restricted
  prod:
    mode: enforce
    failOnSeverity: medium
    directives:
      minScore: 95
      allowDemoCleartext: false
      sampleEnvironmentLabel: android-prod
    ruleOverrides:
      mobile.android.cleartext-traffic-enabled:
        severity: critical
      mobile.android.debuggable-enabled:
        severity: high
      mobile.android.allow-backup-enabled:
        severity: medium
    targets:
      mobile:
        directives:
          platform: android
          networkProfile: strict
          requireTlsEverywhere: true
