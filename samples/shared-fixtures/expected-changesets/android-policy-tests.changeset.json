{
  "env": "prod",
  "changeSet": {
    "dryRun": true,
    "summary": "Generated 1 policy test file for android/prod",
    "changes": [
      {
        "kind": "create",
        "path": "android/app/src/test/java/com/panthereyes/policy/PantherEyesPolicyProdTest.java",
        "language": "java",
        "reason": "Deterministic policy regression test generated from effective policy and directives.",
        "content": "package com.panthereyes.policy;\n\nimport static org.junit.Assert.assertEquals;\nimport static org.junit.Assert.assertTrue;\n\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\nimport org.junit.Before;\nimport org.junit.Test;\n\npublic final class PantherEyesPolicyProdTest {\n    private final List<String> ruleIds = new ArrayList<>();\n    private final Map<String, String> directives = new HashMap<>();\n    private final String mode = \"enforce\";\n    private final String failOnSeverity = \"medium\";\n\n    @Before\n    public void setUp() {\n        ruleIds.add(\"mobile.android.allow-backup-enabled\"); // enabled=true, severity=medium\n        ruleIds.add(\"mobile.android.cleartext-traffic-enabled\"); // enabled=true, severity=critical\n        ruleIds.add(\"mobile.android.debuggable-enabled\"); // enabled=true, severity=high\n        ruleIds.add(\"mobile.android.hardcoded-fake-secret\"); // enabled=true, severity=medium\n        directives.put(\"allowDemoCleartext\", \"false\");\n        directives.put(\"minScore\", \"95\");\n        directives.put(\"networkProfile\", \"\\\"strict\\\"\");\n        directives.put(\"platform\", \"\\\"android\\\"\");\n        directives.put(\"requireExceptionApproval\", \"true\");\n        directives.put(\"requireTlsEverywhere\", \"true\");\n        directives.put(\"sampleEnvironmentLabel\", \"\\\"android-prod\\\"\");\n    }\n\n    @Test\n    public void testPolicyMetadata_prod() {\n        assertEquals(\"enforce\", mode);\n        assertEquals(\"medium\", failOnSeverity);\n        assertTrue(ruleIds.size() >= 4);\n    }\n\n    @Test\n    public void testDirectives_prod() {\n        assertEquals(\"false\", directives.get(\"allowDemoCleartext\"));\n        assertEquals(\"95\", directives.get(\"minScore\"));\n        assertEquals(\"\\\"strict\\\"\", directives.get(\"networkProfile\"));\n        assertEquals(\"\\\"android\\\"\", directives.get(\"platform\"));\n        assertEquals(\"true\", directives.get(\"requireExceptionApproval\"));\n        assertEquals(\"true\", directives.get(\"requireTlsEverywhere\"));\n        assertEquals(\"\\\"android-prod\\\"\", directives.get(\"sampleEnvironmentLabel\"));\n    }\n\n    @Test\n    public void testRule_mobile_android_allow_backup_enabled_isPresent() {\n        assertTrue(ruleIds.contains(\"mobile.android.allow-backup-enabled\"));\n    }\n\n    @Test\n    public void testRule_mobile_android_cleartext_traffic_enabled_isPresent() {\n        assertTrue(ruleIds.contains(\"mobile.android.cleartext-traffic-enabled\"));\n    }\n\n    @Test\n    public void testRule_mobile_android_debuggable_enabled_isPresent() {\n        assertTrue(ruleIds.contains(\"mobile.android.debuggable-enabled\"));\n    }\n\n    @Test\n    public void testRule_mobile_android_hardcoded_fake_secret_isPresent() {\n        assertTrue(ruleIds.contains(\"mobile.android.hardcoded-fake-secret\"));\n    }\n}\n"
      }
    ]
  }
}
